import { forwardRef, ReactNode } from 'react'
import clsx from 'clsx'

import styles from './Button.module.css'

export const BUTTON_VARIANTS = {
  default: styles.default,
  bold: styles.bold,
  reverse: styles.reverse,
  primary: styles.primary,
  secondary: styles.secondary,
  tertiary: styles.tertiary,
  quaternary: styles.quaternary,
  text: styles.text,
  smallText: styles.smallText,
  giftNow: styles.giftNow,
}

export interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  compact?: boolean
  children: ReactNode
  variant?: keyof typeof BUTTON_VARIANTS
  href?: string
}

export type ButtonRef = HTMLButtonElement | HTMLAnchorElement

const Button = forwardRef<ButtonRef, ButtonProps>(function Button(
  { className, compact = false, children, variant = 'default', ...props },
  ref
) {
  if (!BUTTON_VARIANTS[variant]) {
    throw new Error(
      `Invalid Button variant: ${variant}\nMust be one of ${Object.keys(BUTTON_VARIANTS).join(
        ', '
      )}`
    )
  }

  const Element = props.href ? 'a' : 'button'

  return (
    <Element
      className={clsx(
        styles.button,
        BUTTON_VARIANTS[variant],
        compact ? styles.compact : '',
        className
      )}
      // @ts-ignore because polymorphic typing is complex
      ref={ref}
      {...props}
    >
      {children}
      <svg xmlns="http://www.w3.org/2000/svg" width="138" height="56" viewBox="0 0 138 56">
        <path d="m137.7534.4426c-.2532-.2396-.6767-.4033-1.0294-.4149-1.4143-.0462-2.8311-.0211-4.2469-.0195-6.2799.0073-12.5597.0228-18.8396.0217-7.0306-.0013-14.0611-.0218-21.0917-.0256-.6346-.0003-1.2692.0008-1.9038.0007.0188.2009.043.4041.0628.6055-.1017-.2001-.1975-.3965-.304-.5996-5.796.0025-11.5922.0073-17.3884.0067-6.7234-.0007-13.447-.0109-20.1704-.0114-7.5084-.0005-15.0165.0076-22.5248.0074-8.2761-.0002-16.552-.0063-24.828-.0087-1.4506-.0004-2.9012-.0038-4.3517.0105C.3424.0234-.0679.4472.0092,1.1345c.0569.5044.4288.8278,1.1228.8042.9573-.0325,1.8512.1874,2.7612.4381,2.6186.7214,4.768,2.233,6.7611,3.9893,1.4944,1.3169,2.9062,2.727,4.3763,4.0722,1.371,1.2547,2.9771,1.7096,4.7829,1.193,1.2932-.37,2.5607-.8299,3.8421-1.2423,2.1084-.6787,4.2063-.8603,6.2697.1662,2.3462,1.1672,3.8144,3.019,4.3547,5.595.4606,2.1955.2799,4.3944-.0737,6.5696-.4598,2.8273-1.0614,5.6311-1.5551,8.4533-.3128,1.787-.4405,3.5946-.1668,5.4027.2469,1.6302,1.0336,2.9461,2.4072,3.8799,2.3809,1.6185,5.6845.7064,6.9298-1.8653.7211-1.4895,1.0129-3.0628.8575-4.6739-.2617-2.7139-.6386-5.4171-.9919-8.1216-.2552-1.9528-.4344-3.9117-.1399-5.8664.2635-1.7486,1.0079-3.287,2.3894-4.4523.9494-.8008,2.0404-1.3383,3.2167-1.7399,2.4007-.8194,4.7495-.6787,6.9932.4445,3.0489,1.5266,4.8914,4.0677,5.7226,7.3349.3228,1.2688.5331,2.5742.6881,3.8756.1466,1.232.3087,2.4955.192,3.7191-.3173,3.3261-.77,6.6395-1.1865,9.9558-.2167,1.7262-.4644,3.4487-.7086,5.1714-.323,2.2795-.3758,4.5552.0775,6.8246.4623,2.3148,1.6535,4.0348,4.0194,4.6937,2.1582.601,4.2761.1293,5.6215-1.8227,1.229-1.7833,1.6109-3.8159,1.6852-5.9185.0845-2.3898-.4743-4.71-.8783-7.044-.5148-2.9744-1.1112-5.9365-1.5464-8.9224-.3698-2.5365-.4806-5.0991.12-7.6322.2619-1.1048.6864-2.1487,1.4088-3.0363,1.9587-2.4063,5.148-3.0156,8.0942-2.0004,1.3119.4521,2.4202,1.2432,3.4852,2.0991,1.1692.9396,2.3413,1.8464,3.7289,2.4804,1.4612.6677,2.9317.9788,4.4597.4557,1.0426-.3569,1.7283-.2464,4.3485-2.4385,1.1764-1.0693,1.7388-2.2454,2.5172-3.293.3694-.4972.65-1.0818.8697-1.6647.5479-1.4539,1.0785-2.907,2.0596-4.1459,1.5204-1.92,3.4778-2.8498,5.9363-2.6559,1.6224.128,3.0636.7523,4.3898,1.6628,1.6264,1.1166,2.7715,2.5796,3.3256,4.5064.5071,1.7639.6987,3.5641.5359,5.3699-.3138,3.4812-.7315,6.9531-1.1161,10.4277-.21,1.8982-.5486,3.7912-.3509,5.7096.2002,1.9436.8768,3.637,2.6995,4.646,1.6336.9043,3.3342,1.144,5.0411.2795,2.1046-1.0658,3.0055-2.9534,3.2005-5.1976.2368-2.7237-.4527-5.3563-.9171-8.0093-.4557-2.6035-1.0012-5.1989-1.2909-7.8218-.3095-2.8017-.2796-5.6254.4869-8.3856.4363-1.5716,1.0812-3.0473,2.0017-4.3966,1.3383-1.9616,3.0649-3.5141,5.0999-4.7129.9808-.5777,1.995-1.1152,3.0405-1.5619,1.7611-.7525,3.6365-.8506,5.5269-.7822.2681.0098.5505-.0145.8062-.0906.6373-.1897.8873-.9681.4126-1.4172Z" />
      </svg>
    </Element>
  )
})

export default Button
